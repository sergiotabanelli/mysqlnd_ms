--TEST--
mysqlnd_ms_check_gtid_in_set(string gtid_set, string gtid)
--SKIPIF--
<?php
require_once('skipif.inc');
?>
--INI--
mysqlnd_ms.enable=1
--FILE--
<?php

	if (!is_null($ret = @mysqlnd_ms_check_gtid_in_set()))
		printf("[001] Expecting NULL got %s\n", var_export($ret, true));

	if (!is_null($ret = @mysqlnd_ms_check_gtid_in_set("test")))
	  printf("[002] Expecting NULL got %s\n", var_export($ret, true));

	$pattern = array(
		array('', '', false),
		array('%', '1234', false),
		array('1234', '%', true),
		array('1234', '1233', true),
		array('1234', '1235', false),
		array('xxxx:1234', '1233', true),
		array('xxxx:1234', '1235', false),
		array('1234', 'xxxx:1233', true),
		array('1234', 'xxxxx:1235', false),
		array('xxxx:1234', 'xxxx:1233', false),
		array('xxxx:1234', 'xxxxx:1235', false),
		array('00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157', '00030003-0003-0003-0003-000300030003:3244155', false),
		array('00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157', '00030003-0003-0003-0003-000300030003:3903665', true),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157', '00030003-0003-0003-0003-000300030003:3903665', false),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157,00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157', '00030003-0003-0003-0003-000300030003:3903665', true),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157,00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157', '00030003-0003-0003-0003-000300030003:3605705', true),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903666:4680975-4865157,00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:4680975-4865157', '00030003-0003-0003-0003-000300030003:3903666', false),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903666:4680975-4865157,00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:3903700:4680975-4865157', '00030003-0003-0003-0003-000300030003:3903700', true),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903666:4680975-4865157,00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:3903700:4680975-4865157', '00030003-0003-0003-0003-000300030003:3903699', false),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903666:4680975-4865157,00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:3903700:4680975-4865157', '10030003-0003-0003-0003-000300030003:4865157', true),
		array('10030003-0003-0003-0003-000300030003:1-3244154:3605705-3903666:4680975-4865157,00030003-0003-0003-0003-000300030003:1-3244154:3605705-3903665:3903700:4680975-4865157', '10030003-0003-0003-0003-000300030003:3903700', false),
		array('00030003-0003-0003-0003-000300030003:1-33599947:33869527-33954616:34938387-34967084', '00030003-0003-0003-0003-000300030003:34967075', true),
		array('00030003-0003-0003-0003-000300030003:1-33640560:33869527-33975650:34938387-34989070','00030003-0003-0003-0003-000300030003:33640556', true)
	);

	foreach ($pattern as $details) {
		if (($ret = mysqlnd_ms_check_gtid_in_set($details[0], $details[1])) !== $details[2]) {
			printf("[003] Expecting %s got %s when checking '%s' against pattern '%s'.\n",
			  ($details[2]) ? 'true' : 'false', ($ret) ? 'true' : 'false',
			  $details[0], $details[1]);
		}
	}

	print "done!";

?>
--EXPECTF--
done!